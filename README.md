# Sheet Block Editor
[![Built on Blockly](https://tinyurl.com/built-on-blockly)](https://github.com/google/blockly)

Sheet Block Editor is a block-based visual programming editor for Google Sheets. The editor can read a text formula and represent its parts as building blocks. These blocks can be edited and reconfigured then writen back out as text for use in a Google Sheet. Formulas can also be made with blocks from scratch. [Try it out](https://tjbearse.github.io/sheet-block-editor/)

Currently the editor is in an experimental state. The editor exists on its own [webpage](https://tjbearse.github.io/sheet-block-editor/) to be used alongside Google Sheets via copying and pasting. Adapting the editor to be an extension for Google Sheets has been started and would provide a smoother integration. Additionally, there are some functionality limitations. See the list of [known feature gaps](https://github.com/tjbearse/sheet-block-editor/issues?q=is%3Aopen+is%3Aissue+label%3A%22unsupported+forumulas%22).

If you encounter bugs or would like to suggest an improvement please create an issue.


## Development

### Setup

1. Generate block definitions: `(cd src/generateBlockDef && python3 generate.py --all)`
2. Install node modules `npm i`
3. Start the webserver `npm start`. Open http://localhost:3000/

### Source Tour
```
.
├── public/: html and css
└── src/
    ├── appscript/: code specific to google appscript implementation
    ├── blockSheets/: defines the block language and related behaviors
    │   ├── blocks/: block definition code.
    │   │   ├── theme.json: definitions generated by generateBlockDef script with additional modifications
    │   │   ├── generated/: definitions generated by generateBlockDef script.
    │   │   └── ...: Hand written definitions are organized by category.
    │   ├── codeGenerators/: generate code/notation from blocks
    │   │   ├── googleSheetsFormula/
    │   │   └── latex/
    │   └── parsing/: turn formula text into blocks
    ├── webapp.js: entrypoint for standalone web app.
    └── generateBlockDef/: python script for generating block definitions
```

### Targets
There are two main build targets, the Github pages site and appscript bundle used in Google sheets. The appscript frontend assets are hostend on the github pages site.

Wepack configs:
- webpack.common.js - elements common to all targets (some overrides)
- webpack.pages.js (`npm run build-pages`) - the github pages site.
- webpack.appscript.js (`npm run build-appscript`) - the appscript bundle (also builds pages somewhat unnecessarily).
- webpack.dev.js (`npm run start`) - builds github pages, appscript bundle and a test page to simulate the appscript frontend integration.

### Build directory tour:
```
build
├── appscript
│   ├── index.html (dev, appscript) - deployed to appscript bundle
│   ├── appscript.gs (appscript) - appscript for controlling the modal integration
│   └── test.html (dev) - simulates the modal integration
├── appscript.js - entry point for the appscript page, hosted on github pages
├── blockSheets.js - blocks, parsers, and blockly config for sheet blocks.
├── blockly.js - blockly library
├── index.html - github pages home page
├── index.js - github pages entry point
├── media/ - required by blockly
├── runtime.js - webpack runtime
└── style.css
```

### Publishing GH Pages Site

1. Checkout and pull main
2. Clean the build directory `rm -r build`
3. Build and deploy with `npm run gh-pages`
